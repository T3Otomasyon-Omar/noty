<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Notifications</title>
</head>
<body>
    <h1>Firebase Cloud Messaging Example</h1>
    <p id="token">FCM Token will appear here.</p>
    <button id="requestPermission">Request Notification Permission</button>
    
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getMessaging, getToken, onMessage, isSupported } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-messaging.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBBFtxoPU6_Wa92wL-1YGFvGe5rqk_oxYo",
            authDomain: "notification-3c0be.firebaseapp.com",
            projectId: "notification-3c0be",
            storageBucket: "notification-3c0be.appspot.com",
            messagingSenderId: "492100026014",
            appId: "1:492100026014:web:88b0624ec055d10d17c58f",
            measurementId: "G-GZ1LGYWB85",
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);

        if (await isSupported()) {
            const messaging = getMessaging(app);

            // Request Permission and Get Token
            document.getElementById('requestPermission').addEventListener('click', async () => {
                try {
                    const permission = await Notification.requestPermission();
                    if (permission === 'granted') {
                        const token = await getToken(messaging, {
                            vapidKey: "BAzC49MbuF3VSwJTz3wMIX4Rg1DWm35FRHRM5UEcRzgAAn9jwhH07vaPYdUKILyUs8o60GY33KGv5azwxOYDzfw",
                        });
                        document.getElementById('token').textContent = token;
                        console.log("FCM Token:", token);
                    } else {
                        console.error("Notification permission not granted.");
                    }
                } catch (error) {
                    console.error("Error getting FCM token:", error);
                }
            });

            // Listen for foreground messages
            onMessage(messaging, (payload) => {
                console.log("Message received:", payload);
                const notificationOptions = {
                    body: payload.notification.body,
                    icon: payload.notification.icon,
                };
                new Notification(payload.notification.title, notificationOptions);
            });
        } else {
            console.error("Browser does not support Firebase Messaging.");
        }
    </script>
</body>
</html>
